---
phase: 08-interpretation-guidance
plan: 01
type: execute
---

<objective>
Create the interpretation logic module and integrate Analysis tab into the WFA results page.

Purpose: Establish the foundation for interpretation guidance by creating functions that generate plain-language explanations, detect red flags, and produce insights from WFA results. Add the Analysis tab structure to the results page.

Output: New interpretation module and Analysis tab visible in results UI (content populated in Plan 02).
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-interpretation-guidance/08-RESEARCH.md
@.planning/phases/08-interpretation-guidance/08-CONTEXT.md
@.planning/phases/07-terminology-explanations/07-01-SUMMARY.md

**Key source files:**
@lib/calculations/walk-forward-verdict.ts
@lib/models/walk-forward.ts
@app/(platform)/walk-forward/page.tsx
@components/walk-forward/walk-forward-summary.tsx

**Tech stack available:** React, shadcn/ui, Radix UI, Tailwind CSS, Zustand
**Established patterns:** HoverCard tooltips, Tab-based organization (from Phase 6), Assessment type (good/moderate/concerning)

**Constraining decisions:**
- Phase 6: Tabs instead of Collapsible for clearer navigation
- Phase 7: IS/OOS explanation at headline level as foundational concept
- CONTEXT.md: Analysis tab should explain WHY the verdict, surface red flags, provide insights (not recommendations)
- RESEARCH.md: Use plain language, avoid jargon, frame as "suggests" not "you should"
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create interpretation logic module</name>
  <files>lib/calculations/walk-forward-interpretation.ts</files>
  <action>
Create a new module with functions to generate interpretation content from WFA results:

1. `generateVerdictExplanation(results: WalkForwardResults, assessment: VerdictAssessment): VerdictExplanation`
   - Returns: { headline: string, reasoning: string[], factors: { metric: string, value: string, assessment: Assessment, explanation: string }[] }
   - Headline: Plain-language summary of verdict (from RESEARCH.md "What Does the Verdict Mean?" section)
   - Reasoning: 2-3 bullet points explaining WHY this verdict based on which metrics drove it
   - Factors: Each of the 3 dimensions (efficiency, stability, consistency) with value, assessment, and plain-language explanation

2. `detectRedFlags(results: WalkForwardResults): RedFlag[]`
   - Returns array of: { severity: 'warning' | 'concern', title: string, description: string }
   - Check for red flags from RESEARCH.md:
     - WFE < 50% (concern): "Efficiency below half"
     - WFE wildly varying across windows - use CV > 0.5 (concern): "Inconsistent efficiency"
     - WFE > 120% (warning): "Unusually high efficiency"
     - Consistency < 50% (concern): "More losing than winning windows"
     - Parameters highly unstable - stability < 50% (warning): "Parameter instability"
     - Degradation cascade - later windows performing worse (warning): Check if last 3 windows average < first 3 windows average by >30%
   - Return empty array if no red flags (this is good!)

3. `generateInsights(results: WalkForwardResults, assessment: VerdictAssessment): string[]`
   - Returns 2-3 observation sentences (NOT recommendations)
   - Use "suggests", "indicates", "may mean" language
   - Examples from research:
     - Good results: "Results held up across {N} windows, suggesting the strategy captures patterns that persist in different market conditions."
     - Mixed: "Performance varied between windows, which may indicate the strategy works better in certain market conditions."
     - Poor: "The significant drop from training to testing periods suggests the optimization may have found patterns specific to historical data."

Use existing types: WalkForwardResults, Assessment, VerdictAssessment from walk-forward-verdict.ts.
Export all interfaces and functions.
Follow codebase conventions: camelCase functions, PascalCase types, JSDoc for public API.
  </action>
  <verify>npm run typecheck passes with no errors in the new file</verify>
  <done>New module exists at lib/calculations/walk-forward-interpretation.ts with all 3 functions exported and properly typed</done>
</task>

<task type="auto">
  <name>Task 2: Add Analysis tab to results page</name>
  <files>app/(platform)/walk-forward/page.tsx</files>
  <action>
Add a fourth "Analysis" tab to the existing Tabs component in the WFA results page:

1. Import the new interpretation functions from lib/calculations/walk-forward-interpretation.ts
2. Import Lightbulb icon from lucide-react for the Analysis tab icon
3. Add TabsTrigger for "Analysis" tab after "Window Data" trigger:
   - Icon: Lightbulb
   - Label: "Analysis" (hidden on small screens like other tabs)
   - Place as FIRST tab (most important for newcomers) but keep "details" as defaultValue for now

4. Add TabsContent for "Analysis" tab with placeholder structure:
   - Card with CardHeader: "Analysis" title, description "Understanding your walk-forward results"
   - CardContent placeholder: "Analysis content coming in next plan"
   - This establishes the tab integration; full content in Plan 02

5. Update TabsList to use grid-cols-4 instead of grid-cols-3

Wire up the interpretation functions to generate data (store in useMemo):
- Call generateVerdictExplanation, detectRedFlags, generateInsights
- Pass assessment from assessResults (already imported)
- These will be used by the Analysis component in Plan 02
  </action>
  <verify>npm run typecheck passes; npm run build succeeds</verify>
  <done>Analysis tab appears in results page tabs, placeholder content displays when tab is clicked</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run typecheck` passes
- [ ] `npm run build` succeeds
- [ ] New interpretation module exports all 3 functions
- [ ] Analysis tab is visible in the tab list
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Interpretation logic properly generates content from WFA results
- Analysis tab is integrated into page structure
</success_criteria>

<output>
After completion, create `.planning/phases/08-interpretation-guidance/08-01-SUMMARY.md`
</output>
