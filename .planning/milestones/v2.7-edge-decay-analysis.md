# Milestone v2.7: Edge Decay Analysis

**Status:** SHIPPED 2026-02-06
**Phases:** 46-50
**Total Plans:** 11

## Overview

Five phases deliver the edge decay analysis tool bottom-up: two foundational calculation engines (period segmentation + rolling metrics), then Monte Carlo regime comparison, walk-forward degradation tracking, and live alignment signal as independent analysis modules, culminating in verdict synthesis and tool registration that wires everything into the unified MCP tool.

## Phases

### Phase 46: Core Calculation Engines

**Goal**: Users can see period-segmented statistics with trend detection and rolling metric trajectories for any block
**Depends on**: Nothing (foundational calculations)
**Plans**: 3 plans

Plans:
- [x] 46-01-PLAN.md -- Period segmentation engine + trend detection + tests
- [x] 46-02-PLAN.md -- Rolling metrics engine + seasonal averages + recent comparison + tests
- [x] 46-03-PLAN.md -- MCP tool registration (analyze_period_metrics, analyze_rolling_metrics) + CLI verification

**Details:**
- Requirements: PSEG-01, PSEG-02, PSEG-03, ROLL-01, ROLL-02, ROLL-03, ROLL-04
- Created: trend-detection.ts (120 lines), period-segmentation.ts (583 lines), rolling-metrics.ts (617 lines)
- 62 new tests (30 period + 32 rolling)
- MCP server: 0.6.1 -> 0.7.0

### Phase 47: Monte Carlo Regime Comparison

**Goal**: Users can compare forward-looking risk profiles between full trade history and recent trading window
**Depends on**: Phase 46 (needs recent window concept established)
**Plans**: 2 plans

Plans:
- [x] 47-01-PLAN.md -- MC regime comparison engine + divergence classification + TDD tests
- [x] 47-02-PLAN.md -- MCP tool registration (analyze_regime_comparison) + CLI verification

**Details:**
- Requirements: MCRG-01, MCRG-02, MCRG-03, MCRG-04
- Created: mc-regime-comparison.ts (337 lines)
- 22 new tests
- Divergence classification: aligned / mild_divergence / significant_divergence / regime_break
- MCP server: 0.7.0 -> 0.7.1

### Phase 48: Walk-Forward Degradation

**Goal**: Users can track whether out-of-sample performance is degrading over time relative to in-sample performance
**Depends on**: Nothing (independent of Phases 46-47)
**Plans**: 2 plans

Plans:
- [x] 48-01-PLAN.md -- WFD calculation engine + efficiency tracking + trend detection + tests
- [x] 48-02-PLAN.md -- MCP tool registration (analyze_walk_forward_degradation) + CLI verification

**Details:**
- Requirements: WFD-01, WFD-02, WFD-03, WFD-04
- Created: walk-forward-degradation.ts (474 lines)
- 21 new tests
- Progressive walk-forward with 365d IS / 90d OOS / 90d step
- MCP server: 0.7.1 -> 0.7.2

### Phase 49: Live Alignment Signal

**Goal**: Users can assess whether live execution matches backtest expectations when reporting log data exists
**Depends on**: Nothing (independent module)
**Plans**: 2 plans

Plans:
- [x] 49-01-PLAN.md -- Live alignment calculation engine + trade matching + direction agreement + execution efficiency + trend detection + tests
- [x] 49-02-PLAN.md -- MCP tool registration (analyze_live_alignment) + graceful skip + CLI verification

**Details:**
- Requirements: LIVE-01, LIVE-02, LIVE-03, LIVE-04
- Created: trade-matching.ts (245 lines), live-alignment.ts (550 lines)
- Refactored: slippage-helpers.ts, performance.ts (shared utilities)
- 35 new tests
- MCP server: 0.7.2 -> 0.7.3

### Phase 50: Verdict Synthesis & Tool Registration

**Goal**: Users can run a single `analyze_edge_decay` MCP tool that aggregates all 5 signal categories into structured factual data for LLM interpretation
**Depends on**: Phases 46, 47, 48, 49
**Plans**: 2 plans

Plans:
- [x] 50-01-PLAN.md -- Edge decay synthesis engine (pure lib function) + TDD tests
- [x] 50-02-PLAN.md -- MCP tool registration (analyze_edge_decay) + CLI verification + version bump

**Details:**
- Requirements: VERD-01, VERD-02, VERD-03, VERD-04, VERD-05, API-01, API-02, API-03, API-04
- Created: edge-decay-synthesis.ts (602 lines)
- 12 new tests
- Exhaustive factual observations, graceful signal skipping, monthly truncation
- MCP server: 0.7.3 -> 0.8.0

---

## Milestone Summary

**Key Decisions:**
- Data-not-interpretation: All outputs are structured factual data for LLM interpretation, no verdicts, no grades
- Exhaustive observations: ALL metric comparisons included, no threshold filtering
- Graceful signal skipping: MC skips when <30 trades, live alignment skips when no reporting log
- Rolling series exclusion: Full rolling series excluded from unified tool output (too large for MCP)
- Monthly truncation: Limited to most recent 12 months in unified tool
- Per-contract normalization: Live alignment uses per-contract P/L for fair comparison
- Separate seeds for dual MC: full history seed vs seed+10000 for recent window
- Lightweight WFD engine: Built purpose-built rather than reusing WalkForwardAnalyzer
- Trade matching extraction: Shared utilities moved from MCP server to lib package

**Issues Resolved:**
- DuckDB file lock during CLI testing (another process held lock)
- Strategy filter partial matching (documented as exact-match behavior)
- Test data size for edge decay synthesis tests (needed 500+ trades for meaningful recent window)

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None identified

---

_For current project status, see .planning/ROADMAP.md_
